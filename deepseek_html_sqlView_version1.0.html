<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oracle视图生成器 | 专业版</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary: #1e90ff;
            --secondary: #00ced1;
            --dark-bg: #0f172a;
            --darker-bg: #0a0f1f;
            --panel-bg: rgba(15, 25, 45, 0.9);
            --text: #f0f9ff;
            --border: rgba(30, 144, 255, 0.3);
            --success: #00c9a7;
            --warning: #ff9e44;
        }
        
        body {
            background: linear-gradient(135deg, var(--darker-bg), var(--dark-bg));
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            padding: 20px;
            display: flex;
            flex-direction: column;
            line-height: 1.6;
        }
        
        /* 头部样式 */
        .header {
            text-align: center;
            padding: 20px 0 40px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 700;
            letter-spacing: 1px;
        }
        
        .header p {
            font-size: 1.2rem;
            color: rgba(240, 249, 255, 0.7);
            line-height: 1.6;
        }
        
        .features {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 25px;
        }
        
        .feature {
            background: rgba(30, 144, 255, 0.1);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 0.95rem;
        }
        
        /* 主容器 */
        .container {
            display: flex;
            gap: 25px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
        }
        
        /* 面板通用样式 */
        .panel {
            background: var(--panel-bg);
            border-radius: 12px;
            padding: 30px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }
        
        .panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(30, 144, 255, 0.2);
        }
        
        .panel-header h2 {
            font-size: 1.6rem;
            color: var(--primary);
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        
        .panel-header i {
            margin-right: 12px;
            font-size: 1.8rem;
            color: var(--primary);
        }
        
        /* 左侧面板样式 */
        .left-panel {
            flex: 1;
            min-width: 450px;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: var(--primary);
            font-weight: 500;
            display: flex;
            align-items: center;
        }
        
        .input-group label i {
            margin-right: 10px;
            font-size: 1.1rem;
        }
        
        .input-group input,
        .input-group textarea {
            width: 100%;
            padding: 14px 18px;
            border-radius: 8px;
            background: rgba(10, 20, 40, 0.7);
            border: 1px solid var(--border);
            color: var(--text);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .input-group input:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(15, 30, 60, 0.7);
            box-shadow: 0 0 0 3px rgba(30, 144, 255, 0.2);
        }
        
        .input-group input::placeholder,
        .input-group textarea::placeholder {
            color: rgba(240, 249, 255, 0.4);
        }
        
        .input-group textarea {
            min-height: 200px;
            resize: vertical;
            font-family: 'Consolas', 'Courier New', monospace;
            line-height: 1.5;
        }
        
        .options {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .option-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .option-group label {
            color: var(--text);
            font-size: 0.95rem;
        }
        
        .generate-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: #fff;
            border: none;
            padding: 16px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(30, 144, 255, 0.3);
        }
        
        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 144, 255, 0.4);
        }
        
        .generate-btn:active {
            transform: translateY(0);
        }
        
        /* 右侧面板样式 */
        .right-panel {
            flex: 1;
            min-width: 450px;
        }
        
        .result-container {
            background: rgba(10, 20, 40, 0.7);
            border-radius: 8px;
            border: 1px solid var(--border);
            padding: 20px;
            height: 100%;
            overflow: auto;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 1rem;
            line-height: 1.6;
            white-space: pre-wrap;
            min-height: 300px;
        }
        
        .result-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .result-container::-webkit-scrollbar-track {
            background: rgba(10, 20, 40, 0.5);
        }
        
        .result-container::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        .result-placeholder {
            color: rgba(240, 249, 255, 0.5);
            font-style: italic;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }
        
        /* SQL 语法高亮 */
        .keyword {
            color: #ff79c6;
            font-weight: bold;
        }
        
        .function {
            color: #50fa7b;
        }
        
        .comment {
            color: #6272a4;
        }
        
        .object {
            color: #f1fa8c;
        }
        
        .string {
            color: #ffb86c;
        }
        
        /* 响应式设计 */
        @media (max-width: 1000px) {
            .container {
                flex-direction: column;
            }
            
            .left-panel, .right-panel {
                min-width: 100%;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
        }
        
        .footer {
            text-align: center;
            padding: 30px 0 20px;
            color: rgba(240, 249, 255, 0.6);
            font-size: 0.95rem;
            margin-top: 20px;
        }
        
        /* 网格背景 */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(30, 144, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(30, 144, 255, 0.05) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -1;
        }
        
        /* 提示信息 */
        .info {
            background: rgba(0, 201, 167, 0.1);
            border: 1px solid var(--success);
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }
        
        .info i {
            color: var(--success);
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-database"></i> Oracle 视图生成器</h1>
        <p>输入您的数据库用户名、视图名称和SQL查询语句，系统将自动生成正确的创建视图SQL命令</p>
        
        <div class="features">
            <div class="feature"><i class="fas fa-check-circle"></i> 生成正确的CREATE VIEW语法</div>
            <div class="feature"><i class="fas fa-check-circle"></i> 支持OR REPLACE选项</div>
            <div class="feature"><i class="fas fa-check-circle"></i> 支持FORCE选项</div>
            <div class="feature"><i class="fas fa-check-circle"></i> 自动语法高亮</div>
        </div>
    </div>
    
    <div class="container">
        <!-- 左侧输入面板 -->
        <div class="panel left-panel">
            <div class="panel-header">
                <h2><i class="fas fa-cog"></i> 配置视图参数</h2>
            </div>
            
            <div class="info">
                <i class="fas fa-info-circle"></i> 请确保您有创建视图的权限，视图名称需符合Oracle命名规范
            </div>
            
            <div class="input-group">
                <label for="username"><i class="fas fa-user"></i> 用户名</label>
                <input type="text" id="username" placeholder="输入数据库用户名 (例如: HR)">
            </div>
            
            <div class="input-group">
                <label for="viewname"><i class="fas fa-table"></i> 视图名</label>
                <input type="text" id="viewname" placeholder="输入视图名称 (例如: EMPLOYEE_DETAILS_VIEW)">
            </div>
            
            <div class="input-group">
                <label for="sql"><i class="fas fa-code"></i> SQL 查询语句</label>
                <textarea id="sql" placeholder="输入完整的SQL查询语句&#10;例如: SELECT employee_id, first_name, last_name, department_name, salary FROM employees e JOIN departments d ON e.department_id = d.department_id"></textarea>
            </div>
            
            <div class="options">
                <div class="option-group">
                    <input type="checkbox" id="replace" checked>
                    <label for="replace">使用 OR REPLACE</label>
                </div>
                <div class="option-group">
                    <input type="checkbox" id="force">
                    <label for="force">使用 FORCE</label>
                </div>
                <div class="option-group">
                    <input type="checkbox" id="readonly">
                    <label for="readonly">WITH READ ONLY</label>
                </div>
            </div>
            
            <button class="generate-btn" id="generate">
                <i class="fas fa-bolt"></i> 生成视图SQL
            </button>
        </div>
        
        <!-- 右侧结果面板 -->
        <div class="panel right-panel">
            <div class="panel-header">
                <h2><i class="fas fa-terminal"></i> 生成的SQL语句</h2>
            </div>
            
            <div class="result-container" id="result">
                <div class="result-placeholder">
                    <div>
                        <i class="fas fa-arrow-left" style="font-size: 2rem; margin-bottom: 15px;"></i>
                        <p>在左侧填写信息<br>点击"生成视图SQL"按钮</p>
                    </div>
                </div>
            </div>
            
            <div class="info" style="margin-top: 20px;">
                <i class="fas fa-lightbulb"></i> 使用提示：在Oracle SQL Developer或SQL*Plus中执行生成的SQL语句即可创建视图
            </div>
        </div>
    </div>
    
    <div class="footer">
        Oracle 视图生成器 v2.0 | 专业版 | © 2023 数据库工具 | 已修复SQL生成问题
    </div>

    <script>
        // 生成SQL功能
        document.getElementById('generate').addEventListener('click', function() {
            const username = document.getElementById('username').value.trim();
            const viewname = document.getElementById('viewname').value.trim();
            let sql = document.getElementById('sql').value.trim();
            
            if (!username || !viewname || !sql) {
                alert('请填写所有必填字段！');
                return;
            }
            
            // 获取选项
            const replace = document.getElementById('replace').checked;
            const force = document.getElementById('force').checked;
            const readonly = document.getElementById('readonly').checked;
            
            // 清理SQL语句：去掉末尾分号（如果有）
            if (sql.endsWith(';')) {
                sql = sql.substring(0, sql.length - 1);
            }
            
            // 生成视图创建语句（正确的Oracle语法）
            let viewSQL = '';
            
            if (replace) {
                viewSQL += 'CREATE OR REPLACE ';
            } else {
                viewSQL += 'CREATE ';
            }
            
            if (force) {
                viewSQL += 'FORCE ';
            }
            
            viewSQL += `VIEW ${username}.${viewname} AS\n`;
            viewSQL += sql;
            
            if (readonly) {
                viewSQL += '\nWITH READ ONLY';
            }
            
            viewSQL += ';';
            
            // 语法高亮处理
            const highlightedSQL = highlightSQL(viewSQL);
            
            // 显示结果
            document.getElementById('result').innerHTML = highlightedSQL;
        });
        
        // SQL语法高亮函数
        function highlightSQL(sql) {
            // 关键字列表
            const keywords = [
                'SELECT', 'FROM', 'WHERE', 'CREATE', 'OR', 'REPLACE', 'VIEW', 'AS',
                'AND', 'OR', 'NOT', 'IN', 'BETWEEN', 'LIKE', 'IS', 'NULL', 'JOIN',
                'INNER', 'LEFT', 'RIGHT', 'FULL', 'OUTER', 'ON', 'GROUP BY', 'HAVING',
                'ORDER BY', 'ASC', 'DESC', 'DISTINCT', 'UNION', 'ALL', 'INSERT', 'INTO',
                'VALUES', 'UPDATE', 'SET', 'DELETE', 'TRUNCATE', 'TABLE', 'ALTER',
                'ADD', 'MODIFY', 'DROP', 'COLUMN', 'PRIMARY', 'KEY', 'FOREIGN', 'REFERENCES',
                'INDEX', 'UNIQUE', 'CHECK', 'DEFAULT', 'CONSTRAINT', 'CASCADE', 'COMMIT',
                'ROLLBACK', 'SAVEPOINT', 'GRANT', 'REVOKE', 'FORCE', 'WITH', 'READ', 'ONLY'
            ];
            
            // 函数列表
            const functions = [
                'COUNT', 'SUM', 'AVG', 'MIN', 'MAX', 'ROUND', 'TRUNC', 'TO_CHAR',
                'TO_DATE', 'NVL', 'COALESCE', 'DECODE', 'CASE', 'WHEN', 'THEN', 'ELSE', 'END',
                'SUBSTR', 'INSTR', 'LENGTH', 'UPPER', 'LOWER', 'INITCAP', 'SYSDATE'
            ];
            
            // 注释处理
            let highlighted = sql
                .replace(/--.*$/gm, '<span class="comment">$&</span>')
                .replace(/\/\*[\s\S]*?\*\//gm, '<span class="comment">$&</span>');
            
            // 关键字高亮
            keywords.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
                highlighted = highlighted.replace(regex, `<span class="keyword">${keyword}</span>`);
            });
            
            // 函数高亮
            functions.forEach(func => {
                const regex = new RegExp(`\\b${func}\\b`, 'gi');
                highlighted = highlighted.replace(regex, `<span class="function">${func}</span>`);
            });
            
            // 字符串高亮
            highlighted = highlighted.replace(/'[^']*'/g, '<span class="string">$&</span>');
            
            // 对象名高亮（用户名和视图名）
            const username = document.getElementById('username').value.trim();
            const viewname = document.getElementById('viewname').value.trim();
            if (username) {
                highlighted = highlighted.replace(new RegExp(`\\b${username}\\b`, 'g'), `<span class="object">${username}</span>`);
            }
            if (viewname) {
                highlighted = highlighted.replace(new RegExp(`\\b${viewname}\\b`, 'g'), `<span class="object">${viewname}</span>`);
            }
            
            return highlighted;
        }
        
        // 示例数据填充
        document.addEventListener('DOMContentLoaded', function() {
            // 演示时自动填充一些数据
            setTimeout(() => {
                document.getElementById('username').value = 'HR';
                document.getElementById('viewname').value = 'EMP_DETAILS_VIEW';
                document.getElementById('sql').value = 'SELECT \n    e.employee_id, \n    e.first_name || \' \' || e.last_name AS full_name,\n    d.department_name,\n    e.salary,\n    j.job_title\nFROM employees e\nJOIN departments d ON e.department_id = d.department_id\nJOIN jobs j ON e.job_id = j.job_id\nWHERE e.salary > 5000';
            }, 500);
        });
    </script>
</body>
</html>